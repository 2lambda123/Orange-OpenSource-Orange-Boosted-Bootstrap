.side-nav {
  // scss-docs-start side-nav-css-vars
  --#{$prefix}side-nav-min-width: calc(var(--#{$prefix}side-nav-item-icon-size) + var(--#{$prefix}side-nav-item-spacing) * 2 - var(--#{$prefix}side-nav-border-width)); /* stylelint-disable-line function-disallowed-list */ // Needed due to an FF issue with certain numbers in `linear-gradient` (seems to be a known issue)
  --#{$prefix}side-nav-max-width: 300px;
  --#{$prefix}side-nav-bg: #{$white};
  --#{$prefix}side-nav-border-width: #{1px};
  --#{$prefix}side-nav-border-color: #{$gray-500};
  --#{$prefix}side-nav-item-min-height: #{$spacer * 2};
  --#{$prefix}side-nav-item-icon-size: #{$spacer * 1.25};
  --#{$prefix}side-nav-item-spacing: 15px;
  --#{$prefix}side-nav-item-padding-start: 15px;
  --#{$prefix}side-nav-item-color: #{$black};
  --#{$prefix}side-nav-item-hover-bg: #{$gray-300};
  --#{$prefix}side-nav-item-active-bg: #{$gray-400};
  // scss-docs-end side-nav-css-vars

  position: relative;
  flex-shrink: 0;
  min-width: add(var(--#{$prefix}side-nav-min-width), var(--#{$prefix}side-nav-border-width));
  height: 100%;

  :focus {
    &[data-focus-visible-added] {
      outline-offset: -$focus-visible-outer-width;
      box-shadow: inset 0 0 0 add($focus-visible-inner-width, $focus-visible-outer-width) var(--#{$prefix}focus-visible-inner-color);
    }
  }

  .accordion {
    --#{$prefix}accordion-bg: transparent;
    --#{$prefix}accordion-border-width: 0;
    --#{$prefix}accordion-body-padding-top: 0;
    --#{$prefix}accordion-body-padding-end: 0;
    --#{$prefix}accordion-body-padding-bottom: 0;
    --#{$prefix}accordion-body-padding-start: 0;

    .accordion-button::after {
      margin-right: var(--#{$prefix}side-nav-item-spacing);
    }

    .accordion-body {
      --#{$prefix}side-nav-item-padding-start: calc(var(--#{$prefix}side-nav-item-icon-size) + var(--#{$prefix}side-nav-item-spacing) * 2 - var(--#{$prefix}side-nav-border-width)); /* stylelint-disable-line function-disallowed-list */

      .accordion-body {
        --#{$prefix}side-nav-item-padding-start: calc(var(--#{$prefix}side-nav-item-icon-size) * 2 + var(--#{$prefix}side-nav-item-spacing) * 3 - var(--#{$prefix}side-nav-border-width)); /* stylelint-disable-line function-disallowed-list */
      }
    }
  }

  > * {
    position: absolute;
    overflow: hidden;
    background: var(--#{$prefix}side-nav-bg);
    border-right: var(--#{$prefix}side-nav-border-width) solid var(--#{$prefix}side-nav-border-color);
  }

  &.side-nav-static > * {
    position: relative;
  }

  .side-nav-item {
    position: relative;
    display: flex;
    align-items: center;
    min-width: var(--#{$prefix}side-nav-min-width);
    min-height: var(--#{$prefix}side-nav-item-min-height);
    padding: 8px 0 10px var(--#{$prefix}side-nav-item-padding-start);
    margin: 0;
    font-size: $font-size-base;
    line-height: $line-height-base;
    color: var(--#{$prefix}side-nav-item-color);
    text-decoration: none;
    background-color: transparent;
    border: 0;

    &.active,
    &.active-parent,
    &:active {
      background-color: var(--#{$prefix}side-nav-item-active-bg);
    }

    &:hover {
      background-color: var(--#{$prefix}side-nav-item-hover-bg);
    }

    &.active,
    &.active-parent.collapsed {
      &::before {
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        content: "";
        background-color: $brand-orange;
      }
    }

    svg,
    img {
      width: var(--#{$prefix}side-nav-item-icon-size);
      min-width: var(--#{$prefix}side-nav-item-icon-size);
      height: var(--#{$prefix}side-nav-item-icon-size);
      margin: -8px subtract(var(--#{$prefix}side-nav-item-spacing), var(--#{$prefix}side-nav-border-width)) -10px 0;
    }
  }

  .side-nav-scrollable {
    height: subtract(100%, var(--#{$prefix}side-nav-item-min-height));
    overflow: hidden auto;
    scrollbar-width: thin;

    &::-webkit-scrollbar {
      width: 9px;
      background-color: $gray-300;
    }

    &::-webkit-scrollbar-thumb {
      background-color: $gray-500;
    }
  }
}

.side-nav-toggle {
  align-items: center;
  justify-content: center;
  width: var(--#{$prefix}side-nav-min-width);
  height: var(--#{$prefix}side-nav-item-min-height);
  background-color: transparent;
  border: 0;

  &::before {
    position: absolute;
    top: 0;
    right: 0;
    left: 0;
    height: var(--#{$prefix}side-nav-item-min-height);
    content: "";
  }

  &::after {
    margin-right: 1px;
    content: "";
    border: 7px solid transparent;
    border-right-color: var(--#{$prefix}side-nav-item-color);
    border-left: 0;
    // @include transition(transform .35s ease);
  }

  &.collapsed::after {
    margin-left: 3px;
    transform: rotate(180deg);
  }
}

.side-nav-content {
  display: flex;
  height: subtract(100%, var(--#{$prefix}side-nav-item-min-height));
}

@each $breakpoint in map-keys($grid-breakpoints) {
  $next: breakpoint-next($breakpoint, $grid-breakpoints);
  $infix: breakpoint-infix($next, $grid-breakpoints);

  .offcanvas#{$infix} {
    @include media-breakpoint-down($next) {
      .side-nav > * {
        border: 0;
      }

      .side-nav-content {
        height: 100%;
      }
    }
  }
}

.side-nav-accordion {
  > * {
    width: subtract(var(--#{$prefix}side-nav-max-width), var(--#{$prefix}side-nav-border-width));
  }
}

.side-nav-collapsible {
  .collapse-horizontal {
    margin-left: var(--#{$prefix}side-nav-min-width);

    > * {
      width: subtract(subtract(var(--#{$prefix}side-nav-max-width), var(--#{$prefix}side-nav-min-width)), var(--#{$prefix}side-nav-border-width));
      height: 0;
    }
  }

  .side-nav-content {
    position: absolute;
    flex-direction: column;
    width: 100%;
  }
}

.side-nav-content-with-drawer {
  background: linear-gradient(to right, #{$gray-900} 0%, #{$gray-900} 54px, #{$white} 54px, #{$white} 100%); // Needed because is used out of the side-nav context

  .side-nav-toggle.collapsed::after {
    --#{$prefix}side-nav-item-color: #{$white};
  }
}

.side-nav-dark {
  // scss-docs-start side-nav-dark-css-vars
  --#{$prefix}side-nav-bg: #{$gray-900};
  --#{$prefix}side-nav-border-color: #{$gray-700};
  --#{$prefix}side-nav-item-color: #{$white};
  --#{$prefix}side-nav-item-hover-bg: #{$black};
  --#{$prefix}side-nav-item-active-bg: #{$gray-700};
  // scss-docs-end side-nav-dark-css-vars
}
