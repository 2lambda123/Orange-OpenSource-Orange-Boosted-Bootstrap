{"version":3,"sources":["../src/o-megamenu.js"],"names":["MegaMenu","$","NAME","VERSION","DATA_KEY","JQUERY_NO_CONFLICT","fn","Event","ClassName","TRANSITIONING","Dimension","Selector","MEGAMENU","ROOT_NAV","MEGAMENU_PANEL_NAV","MEGAMENU_NAV","NAV_MENU","NAV_LINK","NAV_BACK_LINK","element","_element","_$goForwardLinks","find","prev","_$goBackLinks","_addEventListeners","_addAriaAttributes","on","_goForward","_goBackward","$subNavs","each","navId","Util","getUID","$thisNavToggler","$thisNav","$thisNavBackLink","attr","e","preventDefault","closest","$targetNav","next","$rootNav","$targetNavBackLink","currentTranslatePos","parseInt","css","split","navWidth","width","hasClass","hide","show","addClass","one","removeClass","first","trigger","parent","$targetNavToggler","_jQueryInterface","config","$this","data","_config","extend","undefined","Error","Constructor","noConflict","jQuery"],"mappings":"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","file":"o-megamenu.js","sourcesContent":["import Util from './util'\n\n/* eslint no-magic-numbers: [\"error\", { \"ignore\": [1,2] }] */\n\n/**\n * --------------------------------------------------------------------------\n * Boosted (v4.0.0-alpha.6): o-megamenu.js\n * Licensed under MIT (https://github.com/Orange-OpenSource/Orange-Boosted-Bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nconst MegaMenu = (($) => {\n\n\n  /**\n   * ------------------------------------------------------------------------\n   * Constants\n   * ------------------------------------------------------------------------\n   */\n\n  const NAME                = 'megamenu'\n  const VERSION             = '4.0.0-alpha.6'\n  const DATA_KEY            = 'bs.megamenu'\n  const JQUERY_NO_CONFLICT  = $.fn[NAME]\n\n  const Event = {\n  }\n\n  const ClassName = {\n    TRANSITIONING: 'transitioning'\n  }\n\n  const Dimension = {\n  }\n\n  const Selector = {\n    MEGAMENU    : '.mega-menu',\n    ROOT_NAV : '.mega-menu > .navbar-nav',\n    MEGAMENU_PANEL_NAV : '.mega-menu-panel > .container > .navbar-nav',\n    MEGAMENU_NAV : '.nav-link + .navbar-nav',\n    NAV_MENU : '.navbar-nav',\n    NAV_LINK : '.nav-link',\n    NAV_BACK_LINK : '.nav-link.back'\n  }\n\n\n  /**\n   * ------------------------------------------------------------------------\n   * Class Definition\n   * ------------------------------------------------------------------------\n   */\n\n  class MegaMenu {\n\n    constructor(element) {\n      this._element = element\n      this._$goForwardLinks = $(this._element).find(Selector.MEGAMENU_NAV).prev(Selector.NAV_LINK)\n      this._$goBackLinks = $(Selector.NAV_BACK_LINK)\n      this._addEventListeners()\n      this._addAriaAttributes(this._element)\n    }\n\n    // getters\n\n    static get VERSION() {\n      return VERSION\n    }\n\n    // public\n\n    // private\n\n    _addEventListeners() {\n      this._$goForwardLinks.on('click', this._goForward)\n      this._$goBackLinks.on('click', this._goBackward)\n    }\n\n    _addAriaAttributes(element) {\n      const $subNavs = $(element).find('.nav-link + .navbar-nav')\n\n      $subNavs.each(function() {\n        const navId = Util.getUID(NAME)\n        const $thisNavToggler = $(this).prev(Selector.NAV_LINK)\n        const $thisNav = $(this)\n        const $thisNavBackLink = $thisNav.find(Selector.NAV_BACK_LINK)\n\n        $thisNav.attr('id', navId)\n        $thisNavToggler.attr({'aria-controls': navId, 'aria-expanded': false, 'aria-haspopup': true})\n        $thisNavBackLink.attr({'aria-controls': navId, 'aria-expanded': false, 'aria-haspopup': true})\n      })\n    }\n\n    _goForward(e) {\n      e.preventDefault();\n\n      const $thisNav = $(this).closest(Selector.NAV_MENU)\n      const $targetNav =  $(this).next(Selector.NAV_MENU)\n      const $rootNav = $(Selector.ROOT_NAV)\n      const $thisNavToggler = $(this)\n      const $targetNavBackLink = $targetNav.find(Selector.NAV_BACK_LINK)\n      const currentTranslatePos = parseInt($rootNav.css('transform').split(',')[4], 10)\n      const navWidth = $rootNav.width()\n\n      if($rootNav.hasClass(ClassName.TRANSITIONING)) {\n          return false\n      }\n\n      // hide all nav on same level\n      $thisNav.find(Selector.NAV_MENU).hide()\n\n      // show target navbar-nav\n      $targetNav.show()\n\n      // make only visible elements focusable\n      if(currentTranslatePos === 0) {\n          $rootNav.find('>.nav-item .nav-link').attr('tabindex', '-1')\n      }\n      $thisNav.find(Selector.NAV_LINK).attr('tabindex', '-1')\n      $targetNav.find(Selector.NAV_LINK).attr('tabindex', '0')\n\n      // handle expanded state\n      $thisNavToggler.attr('aria-expanded', false)\n\n      // translate menu\n      $rootNav.addClass(ClassName.TRANSITIONING)\n      $rootNav.css('transform', 'translateX('+(currentTranslatePos - navWidth)+'px)')\n\n      // focus on target nav first item\n      $rootNav.one('transitionend', function() {\n        $rootNav.removeClass(ClassName.TRANSITIONING)\n        $targetNav.find(Selector.NAV_LINK).first().trigger('focus')\n        $targetNavBackLink.attr('aria-expanded', true)\n      })\n    }\n\n    _goBackward(e) {\n      e.preventDefault()\n\n      const $thisNav = $(this).closest(Selector.NAV_MENU)\n      const $targetNav = $thisNav.parent().closest(Selector.NAV_MENU)\n      const $rootNav = $(Selector.ROOT_NAV)\n      const $targetNavToggler = $targetNav.prev(Selector.NAV_LINK)\n      const $thisNavBackLink = $(this)\n      const currentTranslatePos = parseInt($rootNav.css('transform').split(',')[4], 10)\n      const navWidth = $rootNav.width()\n\n      if($rootNav.hasClass(ClassName.TRANSITIONING)) {\n          return false\n      }\n\n      // make only visible elements focusable\n      $targetNav.find(Selector.NAV_LINK).attr('tabindex', '0')\n      if(currentTranslatePos === -navWidth) {\n          $rootNav.find('>.nav-item .nav-link').attr('tabindex', '0')\n      }\n\n      // handle expanded state\n      $thisNavBackLink.attr('aria-expanded', false)\n\n      // translate menu\n      $rootNav.addClass(ClassName.TRANSITIONING)\n      $rootNav.css('transform', 'translateX('+(currentTranslatePos + navWidth)+'px)')\n\n      // focus on target nav first item\n      $rootNav.one('transitionend', function() {\n        $rootNav.removeClass(ClassName.TRANSITIONING)\n        $targetNav.find(Selector.NAV_LINK).first().trigger('focus')\n        $targetNavToggler.attr('aria-expanded', true)\n        $thisNav.hide()\n      })\n    }\n\n    // static\n\n    static _jQueryInterface(config) {\n      return this.each(function () {\n        const $this   = $(this)\n        let data    = $this.data(DATA_KEY)\n        const _config = $.extend(\n          {},\n        //   Default,\n          $this.data(),\n          typeof config === 'object' && config\n        )\n\n        if (!data) {\n          data = new MegaMenu(this, _config)\n          $this.data(DATA_KEY, data)\n        }\n\n        if (typeof config === 'string') {\n          if (data[config] === undefined) {\n            throw new Error(`No method named \"${config}\"`)\n          }\n          data[config]()\n        }\n      })\n    }\n  }\n\n  /**\n   * ------------------------------------------------------------------------\n   * jQuery\n   * ------------------------------------------------------------------------\n   */\n\n  $.fn[NAME]             = MegaMenu._jQueryInterface\n  $.fn[NAME].Constructor = MegaMenu\n  $.fn[NAME].noConflict  = function () {\n    $.fn[NAME] = JQUERY_NO_CONFLICT\n    return MegaMenu._jQueryInterface\n  }\n\n  return MegaMenu\n\n})(jQuery)\n\nexport default MegaMenu\n"]}